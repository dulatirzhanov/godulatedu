<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Redirecting…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root { color-scheme: light dark }

    /* base */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 50px;
      margin: 0;
      background: #fff;
      color: #333;
    }
    h1 { margin: 0 0 8px }
    p  { margin: 8px 0; color: #444 }

    /* card in brand style */
    .card {
      margin: 0 auto;
      padding: 24px 20px;
      border-radius: 16px;
      background: #fff;
      box-shadow: 0 12px 40px rgba(0,0,0,.25);
      width: calc(100vw - 40px);
      max-width: 420px;
    }

    /* brand CTA like on main site */
    .cta-post {
      display: inline-block;
      margin: 16px 0 0;
      padding: 12px 18px;
      border-radius: 12px;
      font-weight: bold;
      text-decoration: none;
      background: rgba(10,102,194,0.06);
      color: #0a66c2;
      border: 1px solid rgba(10,102,194,0.25);
      transition: background .15s ease, border-color .15s ease;
    }
    .cta-post:hover {
      background: rgba(10,102,194,0.1);
      border-color: rgba(10,102,194,0.35);
    }

    /* dark mode to match your site */
    @media (prefers-color-scheme: dark) {
      body { background: #111; color: #ddd; }
      p { color: #bbb; }

      .card {
        background: #1a1a1a;
        box-shadow: 0 12px 40px rgba(0,0,0,.6);
      }

      .cta-post {
        background: rgba(207,224,255,0.06);
        color: #cfe0ff;
        border: 1px solid rgba(207,224,255,0.22);
      }
      .cta-post:hover {
        background: rgba(207,224,255,0.12);
        border-color: rgba(207,224,255,0.32);
      }
    }
  </style>
</head>
<body>
  <div class="card" role="status" aria-live="polite">
    <h1 id="status">Checking short link…</h1>
    <p id="message"></p>
    <a id="homeBtn" class="cta-post" href="/" style="display:none" rel="noopener">Go to Home</a>
  </div>

  <script>
    (function () {
      var statusEl = document.getElementById('status');
      var messageEl = document.getElementById('message');
      var homeBtn  = document.getElementById('homeBtn');

      var slug = window.location.pathname.replace(/^\/+/, '').replace(/\/+$/, '');
      if (!slug) {
        statusEl.textContent = 'Unknown short code.';
        messageEl.textContent = 'No short code was provided.';
        homeBtn.style.display = 'inline-block';
        return;
        }

      fetch('/data/mapping.json', { cache: 'no-store' })
        .then(function (r) {
          if (!r.ok) throw new Error('Unable to load mapping.');
          return r.json();
        })
        .then(function (mapping) {
          var entry = mapping && mapping[slug];
          var url = entry && entry.final_url;
          if (url) {
            statusEl.textContent = 'Redirecting…';
            messageEl.textContent = 'Sending you to your destination.';
            window.location.replace(url);
          } else {
            statusEl.textContent = 'Unknown short code.';
            messageEl.textContent = 'We could not find a destination for "' + slug + '".';
            homeBtn.style.display = 'inline-block';
          }
        })
        .catch(function (err) {
          statusEl.textContent = 'Redirect failed.';
          messageEl.textContent = err.message;
          homeBtn.style.display = 'inline-block';
        });
    })();
  </script>
</body>
</html>
